<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://mypppv.github.io</id>
    <title>è‹¥æ°´</title>
    <updated>2021-09-03T15:49:12.707Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://mypppv.github.io"/>
    <link rel="self" href="https://mypppv.github.io/atom.xml"/>
    <subtitle>&lt;h2 &gt;&lt;code&gt;ä¸Šå–„è‹¥æ°´ï¼Œæ°´å–„åˆ©ä¸‡ç‰©è€Œä¸äº‰ï¼Œå¤„ä¼—äººä¹‹æ‰€æ¶ï¼Œæ•…å‡ äºé“ã€‚&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;</subtitle>
    <logo>https://mypppv.github.io/images/avatar.png</logo>
    <icon>https://mypppv.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, è‹¥æ°´</rights>
    <entry>
        <title type="html"><![CDATA[How to install Awall on Alpine Linux]]></title>
        <id>https://mypppv.github.io/post/how-to-install-awall-on-alpine-linux/</id>
        <link href="https://mypppv.github.io/post/how-to-install-awall-on-alpine-linux/">
        </link>
        <updated>2021-09-03T15:48:56.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>æœ¬æ–‡ç”± <a href="http://ksria.com/simpread/">ç®€æ‚¦ SimpRead</a> è½¬ç ï¼Œ åŸæ–‡åœ°å€ [www.cyberciti.biz]</p>
</blockquote>
<h2 id="how-to-install-awall-on-alpine-linux">How to install Awall on Alpine Linux</h2>
<p>You need to update system using the <a href="https://www.cyberciti.biz/faq/10-alpine-linux-apk-command-examples/" title="See Linux/Unix apk command examples for more info">apk command</a>:<br>
`# apk update &amp;&amp; apk upgrade</p>
<h2 id="install-both-ipv4-and-ipv6-version-of-iptables">Install both IPv4 and IPv6 version of IPtables</h2>
<h1 id="apk-add-ip6tables-iptables">apk add ip6tables iptables</h1>
<h2 id="install-awall">Install awall</h2>
<h1 id="apk-add-u-awall">apk add -u awall</h1>
<h2 id="verify-it">Verify it</h2>
<h1 id="apk-version-awall">apk version awall`</h1>
<p><img src="https://www.cyberciti.biz/media/new/faq/2020/09/How-To-Set-Up-a-Firewall-with-Awall-on-Alpine-Linux.jpg" alt="How To Set Up a Firewall with Awall on Alpine Linux" loading="lazy"><img src="https://www.cyberciti.biz/media/new/faq/2020/09/How-To-Set-Up-a-Firewall-with-Awall-on-Alpine-Linux.jpg" alt="How To Set Up a Firewall with Awall on Alpine Linux" loading="lazy"></p>
<h2 id="understanding-awall-concepts">Understanding Awall concepts</h2>
<p>Awall configuration starts with a single or multiple JSON-formatted files named policy file. The mandatory policies shipped with Alpine Linux are located at /usr/share/awall/mandatory and viewed with the ls command/<a href="https://www.cyberciti.biz/faq/linux-unix-appleosx-bsd-cat-command-examples/" title="See Linux/Unix cat command examples for more info">cat command</a>:<br>
`# ls -l /usr/share/awall/mandatory/</p>
<h1 id="more-usrshareawallmandatoryservicesjson">more /usr/share/awall/mandatory/services.json</h1>
<h1 id="cat-usrshareawallmandatorydefaultsjson">cat /usr/share/awall/mandatory/defaults.json`</h1>
<p><img src="https://www.cyberciti.biz/media/new/faq/2020/09/Awall-default-policy-files.jpg" alt="Awall default policy files on Alpine Linux" loading="lazy"><img src="https://www.cyberciti.biz/media/new/faq/2020/09/Awall-default-policy-files.jpg" alt="Awall default policy files on Alpine Linux" loading="lazy"><br>
However, developers and sysadmins need to install server specific custom policies in /etc/awall directory:<br>
<code># ls /etc/awall/</code><br>
Each awall policy can contain definitions for:</p>
<ol>
<li><strong>Variables</strong> (like $interface_name)</li>
<li><strong>zones</strong> (like internet, lan, red_zone, green_zone, blue_zone) â€“ ones are defined based on a interface and assigned a name to be used in your policies.</li>
<li><strong>interfaces</strong> (like eth0)</li>
<li><strong>policies</strong> â€“ The policy is what tell Awall what to do with when a packet enters or leaves from one of the zones (interfaces).</li>
<li><strong>filters</strong> and NAT rules</li>
<li><strong>services</strong> (like nginx or mysql)</li>
</ol>
<p><strong>snat</strong> â€“ Apply source nat for outgoing packets. Translate from local ip to public ip. In other words your Alpine box act as a router.</p>
<p>Let us see how to configure Awall for a dedicated VM or bare metal server where eth0 is connected to the high-speed Internet, and we need to protect the server. Our goal is to allow ssh (22), ping, and HTTP (80) + HTTPS (4430 ports only.</p>
<h3 id="step-1-prerequisites">Step 1. Prerequisites</h3>
<p>First we must load Linux kernel drivers (modules) for firewall using the modprobe command:<br>
`# modprobe -v ip_tables # IPv4</p>
<h1 id="modprobe-v-ip6_tables-if-ipv6-is-used">modprobe -v ip6_tables # if IPv6 is used</h1>
<h1 id="modprobe-v-iptable_nat-if-nat-is-used-aka-router">modprobe -v iptable_nat # if NAT is used aka router`</h1>
<pre><code>insmod /lib/modules/5.4.43-1-virt/kernel/net/netfilter/x_tables.ko 
insmod /lib/modules/5.4.43-1-virt/kernel/net/ipv4/netfilter/ip_tables.ko ip6_tables
</code></pre>
<p>Please note that the above commands needed only the first time, after awall installation. Next, make the firewall autostart at boot time and autoload the required Linux kernel modules:<br>
`# <strong>rc-update add iptables</strong></p>
<ul>
<li>service ip6tables added to runlevel default</li>
</ul>
<h1 id="rc-update-add-ip6tables"><strong>rc-update add ip6tables</strong></h1>
<ul>
<li>service ip6tables added to runlevel default<code>Please note that Awall is a frontend tool that creates rules. All firewall rules stored in /etc/iptables/ directory. Firewall service can be stopped or restarted any time using the following commands:</code># ls -l /etc/iptables/</li>
</ul>
<h1 id="cat-etciptablesrules-save">cat /etc/iptables/rules-save</h1>
<h1 id="rc-service-iptables-startstoprestartstatus">rc-service iptables {start|stop|restart|status}</h1>
<h1 id="rc-service-ip6tables-startstoprestartstatus">rc-service ip6tables {start|stop|restart|status}`</h1>
<p><img src="https://www.cyberciti.biz/media/new/faq/2020/09/Alpine-Linux-start-stop-and-restart-firewall-command.jpg" alt="Alpine Linux start stop and restart firewall command" loading="lazy"><img src="https://www.cyberciti.biz/media/new/faq/2020/09/Alpine-Linux-start-stop-and-restart-firewall-command.jpg" alt="Alpine Linux start stop and restart firewall command" loading="lazy"></p>
<p>Alpine Linux command to control iptables firewall</p>
<h3 id="step-2-set-up-a-firewall-with-awall-to-protect-alpine-linux-box">Step 2. Set up a firewall with Awall to protect Alpine Linux box</h3>
<p>Create a new file called cloud-server.json as follows to drop all incoming, and outgoing traffic using a text editor. Here is my sample file to protect cloud server hosted at <a href="https://www.linode.com/">Linode</a>:<br>
<code># cat /etc/awall/optional/cloud-server.json</code></p>
<pre><code>{
  &quot;description&quot;: &quot;Default awall policy to protect Cloud server&quot;,
Â 
  &quot;variable&quot;: { &quot;internet_if&quot;: &quot;eth0&quot; },
Â 
  &quot;zone&quot;: {
    &quot;internet&quot;: { &quot;iface&quot;: &quot;$internet_if&quot; }
  },
Â 
  &quot;policy&quot;: [
    { &quot;in&quot;: &quot;internet&quot;, &quot;action&quot;: &quot;drop&quot; },
    { &quot;action&quot;: &quot;reject&quot; }
  ]
Â 
}
</code></pre>
<p>Next open TCP port 22. In other words, allow incoming SSH access with the maximum ssh login rate limit to avoid attackers/bots brute-forcing into our Alpine cloud server:<br>
<code># cat /etc/awall/optional/ssh.json</code></p>
<pre><code>{
Â 
    &quot;description&quot;: &quot;Allow incoming SSH access (TCP/22)&quot;,
Â 
    &quot;filter&quot;: [
        {
            &quot;in&quot;: &quot;internet&quot;,
            &quot;out&quot;: &quot;_fw&quot;,
            &quot;service&quot;: &quot;ssh&quot;,
            &quot;action&quot;: &quot;accept&quot;,
	    &quot;conn-limit&quot;: { &quot;count&quot;: 3, &quot;interval&quot;: 60 }
        }
    ]
}
</code></pre>
<p>Where,</p>
<ul>
<li><strong>&quot;in&quot;: &quot;internet&quot;,</strong> : The internet is our default zone and we are creating incoming policy to open TCP port 22.</li>
<li><strong>&quot;out&quot;: &quot;_fw&quot;,</strong> : AWall has a built-in zone named â€œ_fwâ€ which is the â€œfirewall itselfâ€.</li>
<li><strong>&quot;service&quot;: &quot;ssh&quot;,</strong> : Open SSH port 22.</li>
<li><strong>&quot;action&quot;: &quot;accept&quot;,</strong> : Accept the packet.</li>
<li><strong>&quot;conn-limit&quot;: { &quot;count&quot;: 3, &quot;interval&quot;: 60 }</strong> : Rate limit ssh connections.</li>
</ul>
<h3 id="a-note-about-restricting-ssh-traffic-from-specific-ip-address-or-subnet-cidr">A note about restricting ssh traffic from specific IP address or sub/net (CIDR)</h3>
<p>Update your ssh.json as follows with &quot;src&quot;: &quot;1.2.3.4&quot;, option:</p>
<pre><code>{
    &quot;description&quot;: &quot;Allow incoming SSH access (TCP/22) only from our office VPN at 1.2.3.4&quot;,
    &quot;filter&quot;: [
        {
            &quot;in&quot;: &quot;internet&quot;,
            &quot;out&quot;: &quot;_fw&quot;,
            &quot;service&quot;: &quot;ssh&quot;,
            &quot;action&quot;: &quot;accept&quot;,
            &quot;src&quot;: &quot;1.2.3.4&quot;,
	    &quot;conn-limit&quot;: { &quot;count&quot;: 3, &quot;interval&quot;: 60 }
        }
    ]
}
</code></pre>
<p>For multiple IPs/CIDRs, try it as follows:</p>
<pre><code>      &quot;src&quot;: [ &quot;1.2.3.4&quot;, &quot;192.168.2.0/24&quot;, &quot;202.54.5.1&quot; ],

</code></pre>
<p>Be a good netizen and allow ping/ICMP request to our server with rate limits applied:<br>
<code># cat /etc/awall/optional/ping.json</code></p>
<pre><code>{
Â 
    &quot;description&quot;: &quot;Allow ping-pong&quot;,
Â 
    &quot;filter&quot;: [
        {
	      &quot;in&quot;: &quot;internet&quot;,
	      &quot;service&quot;: &quot;ping&quot;,
	      &quot;action&quot;: &quot;accept&quot;,
 	      &quot;flow-limit&quot;: { &quot;count&quot;: 10, &quot;interval&quot;: 6 }
        }
    ]
}
</code></pre>
<p>Finally allow selected outgoing connections for HTTP/HTTPS, DNS, ping, ssh, DNS and NTP protocols:<br>
<code># cat /etc/awall/optional/outgoing.json</code></p>
<pre><code>{
Â 
    &quot;description&quot;: &quot;Allow outgoing connections for dns, http/https, ssh, ntp, ssh and ping&quot;,
Â 
    &quot;filter&quot;: [
    	{
            &quot;in&quot;: &quot;_fw&quot;,
            &quot;out&quot;: &quot;internet&quot;,
            &quot;service&quot;: [ &quot;dns&quot;, &quot;http&quot;, &quot;https&quot;, &quot;ssh&quot;, &quot;ntp&quot;, &quot;ping&quot; ],
            &quot;action&quot;: &quot;accept&quot;
	}
    ]
}
</code></pre>
<h3 id="step-3-list-awall-available-policys">Step 3. List Awall available policy(s)</h3>
<p>Run:<br>
<code># awall list</code><br>
Outputs:</p>
<pre><code>cloud-server  disabled  Default awall policy to protect Cloud server
outgoing      disabled  Allow outgoing connections for dns, http/https, ssh, ntp, ssh and ping
ping          disabled  Allow ping-pong
ssh           disabled  Allow incoming SSH access (TCP/22)
</code></pre>
<h3 id="step-4-enables-the-awall-firewall-policy">Step 4. Enables the Awall firewall policy</h3>
<p>Again run:<br>
`# awall enable cloud-server</p>
<h1 id="awall-enable-ssh">awall enable ssh</h1>
<h1 id="awall-enable-ping">awall enable ping</h1>
<h1 id="awall-enable-outgoing">awall enable outgoing`</h1>
<h3 id="step-5-start-the-firewall">Step 5. Start the firewall</h3>
<p>Finally we need to create firewall configuration from the policy files and enables it. In other words the following command will starts the firewall and load all rules:<br>
<code># awall activate</code><br>
You will be prompted to hit the RETURN key as follows:</p>
<pre><code>New firewall configuration activated
Press RETURN to commit changes permanently: 
</code></pre>
<p><strong>NOTE</strong>: After enabling or disabling policy, you always need to run <strong>awall activate</strong> command to update the iptables rules.</p>
<h3 id="step-6-open-incoming-http-and-https-ports">Step 6. Open incoming HTTP and HTTPS ports</h3>
<p>Create a new policy file called apache.json as follows:<br>
<code># vi /etc/awall/optional/apache.json</code></p>
<pre><code>{
    &quot;description&quot;: &quot;Allow incoming Apache HTTP/HTTPS (TCP/80 and 443) ports&quot;,
    &quot;filter&quot;: [
        {
            &quot;in&quot;: &quot;internet&quot;,
            &quot;out&quot;: &quot;_fw&quot;,
            &quot;service&quot;: [ &quot;http&quot;, &quot;https&quot;],
            &quot;action&quot;: &quot;accept&quot;
        }
    ]
}
</code></pre>
<p><a href="https://www.cyberciti.biz/faq/linux-unix-vim-save-and-quit-command/">Save and close the file.</a> Next activate new firewall policy rule:<br>
`# awall enable apache</p>
<h1 id="awall-activate">awall activate`</h1>
<h3 id="step-7-close-port-or-diable-existing-policy">Step 7. Close port or diable existing policy</h3>
<p>Say you have a policy named openvpn.json, and you no longer use the OpenVPN server. We can close the UDP/1194 port as follows by disabling the policy:<br>
`# awall list</p>
<h1 id="awall-disable-openvpn">awall disable openvpn</h1>
<h1 id="awall-activate-2">awall activate`</h1>
<h3 id="step-8-view-iptables-rules">Step 8. View iptables rules</h3>
<p>You can <a href="https://www.cyberciti.biz/faq/how-to-list-all-iptables-rules-in-linux/">list all iptables rules</a> using the following commands:<br>
`# iptables -L -n -v | more</p>
<h1 id="ip6tables-l-n-v-more">ip6tables -L -n -v | more</h1>
<h1 id="ip6tables-s">ip6tables -S</h1>
<h1 id="iptables-s">iptables -S`</h1>
<p><img src="https://www.cyberciti.biz/media/new/faq/2020/09/How-to-list-Alpine-Wall-iptables-rules.jpg" alt="How to list Alpine Wall iptables rules" loading="lazy"><img src="https://www.cyberciti.biz/media/new/faq/2020/09/How-to-list-Alpine-Wall-iptables-rules.jpg" alt="How to list Alpine Wall iptables rules" loading="lazy"><br>
Want to see dropped packets log? Try the dmesg command and <a href="https://www.cyberciti.biz/faq/howto-use-grep-command-in-linux-unix/" title="See Linux/Unix grep command examples for more info">grep command</a>:<br>
`# dmesg</p>
<h2 id="see-dropped-packets-from-ssh-port">See dropped packets from SSH port</h2>
<h1 id="dmesg-grep-w-dpt22">dmesg | grep -w DPT=22`</h1>
<pre><code>[ 3532.077008] IN=eth0 OUT= MAC=f2:3c:92:64:16:11:aa:01:9d:43:81:e6:08:00 SRC=194.180.224.130 DST=172.105.xx.yy LEN=60 TOS=0x00 PREC=0x20 TTL=49 ID=9647 DF PROTO=TCP SPT=33106 DPT=22 WINDOW=29200 RES=0x00 SYN URGP=0 
[ 3532.077347] IN=eth0 OUT= MAC=f2:3c:92:64:16:11:aa:01:9d:43:81:e6:08:00 SRC=194.180.224.130 DST=172.105.xx.yy LEN=60 TOS=0x00 PREC=0x20 TTL=50 ID=35762 DF PROTO=TCP SPT=33110 DPT=22 WINDOW=29200 RES=0x00 SYN URGP=0 
[ 3533.078293] IN=eth0 OUT= MAC=f2:3c:92:64:16:11:aa:01:9d:43:81:e6:08:00 SRC=194.180.224.130 DST=172.105.xx.yy LEN=60 TOS=0x00 PREC=0x20 TTL=50 ID=35763 DF PROTO=TCP SPT=33110 DPT=22 WINDOW=29200 RES=0x00 SYN URGP=0
</code></pre>
<h3 id="step-9-disabling-and-resetting-awall">Step 9. Disabling and resetting Awall</h3>
<p>For any reason you no longer want to use firewall and Awall, you can disable it with following commands:<br>
`# rc-service iptables stop</p>
<h1 id="rc-service-ip6tables-stop">rc-service ip6tables stop`</h1>
<pre><code> * Saving ip6tables state ...                        [ ok ]
 * Stopping firewall ...                             [ ok ]

</code></pre>
<p>Now list and disable all policies:<br>
`# awall list</p>
<h1 id="awall-disable-cloud-server">awall disable cloud-server</h1>
<h1 id="awall-disable-ssh">awall disable ssh</h1>
<h1 id="awall-disable-ping">awall disable ping</h1>
<h1 id="awall-disable-outgoing">awall disable outgoing`</h1>
<p>Finally disable iptables firewall service on your Alpine Linux box using the rc-update command:<br>
`# rc-update del ip6tables</p>
<h1 id="rc-update-del-iptables">rc-update del iptables`</h1>
<p>Patreon supporters only guides ğŸ¤“</p>
<ul>
<li>
<p>No ads and tracking</p>
</li>
<li>
<p>In-depth guides for developers and sysadmins at <a href="https://www.opensourceflare.com">Opensourceflare</a>âœ¨</p>
</li>
<li>
<p>Join my Patreon to support independent content creators and start reading latest guides:</p>
</li>
<li>
<p><a href="https://www.opensourceflare.com/how-to-set-up-redis-sentinel-cluster-on-ubuntu-or-debian-linux/">How to set up Redis sentinel cluster on Ubuntu or Debian Linux</a></p>
</li>
<li>
<p><a href="https://www.opensourceflare.com/how-to-set-up-ssh-keys-with-yubikey-as-two-factor-authentication-u2f-fido2/">How To Set Up SSH Keys With YubiKey as two-factor authentication (U2F/FIDO2)</a></p>
</li>
<li>
<p><a href="https://www.opensourceflare.com/how-to-set-up-mariadb-galera-cluster-on-ubuntu-or-debian-linux/">How to set up Mariadb Galera cluster on Ubuntu or Debian Linux</a></p>
</li>
</ul>
<p><a href="https://www.patreon.com/nixcraft">Join <strong>Patreon</strong> â”</a></p>
<pre><code> * service iptables removed from runlevel default
</code></pre>
<h2 id="conclusion">Conclusion</h2>
<p>In this quick tutorial, we learned about Awall and set up a default firewall policy that drops all incoming and outgoing connections on Alpine Linux. Next, we opened the required ports as per our needs. Try awall help as follows:<br>
<code># awall help</code><br>
See the following resources for further information:</p>
<ul>
<li>Awall <a href="https://gitlab.alpinelinux.org/alpine/awall">project</a> home page.</li>
<li>Awall <a href="https://wiki.alpinelinux.org/wiki/Alpine_Wall">document from the</a> Alpine Linux wiki.</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Alpine Linux å¸¸ç”¨å‘½ä»¤]]></title>
        <id>https://mypppv.github.io/post/alpine-linux-chang-yong-ming-ling/</id>
        <link href="https://mypppv.github.io/post/alpine-linux-chang-yong-ming-ling/">
        </link>
        <updated>2021-09-02T12:56:52.000Z</updated>
        <content type="html"><![CDATA[<p>1</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Alpine Linux æ›´æ¢è½¯ä»¶æº]]></title>
        <id>https://mypppv.github.io/post/alpine-linux-geng-huan-ruan-jian-yuan/</id>
        <link href="https://mypppv.github.io/post/alpine-linux-geng-huan-ruan-jian-yuan/">
        </link>
        <updated>2021-08-31T15:31:19.000Z</updated>
        <content type="html"><![CDATA[<p>æ›´æ¢è½¯ä»¶æºï¼š</p>
<pre><code>setup-apkrepos
</code></pre>
<pre><code>http://mirrors.aliyun.com/alpine/v3.11/main
http://mirrors.aliyun.com/alpine/v3.11/community
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[alpine linuxä½¿ç”¨æ•™ç¨‹]]></title>
        <id>https://mypppv.github.io/post/alpine-linux-shi-yong-jiao-cheng/</id>
        <link href="https://mypppv.github.io/post/alpine-linux-shi-yong-jiao-cheng/">
        </link>
        <updated>2021-08-31T15:11:52.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>æœ¬æ–‡ç”± <a href="http://ksria.com/simpread/">ç®€æ‚¦ SimpRead</a> è½¬ç ï¼Œ åŸæ–‡åœ°å€ <a href="http://www.jichun.wang/archives/161/2021/linux/">www.jichun.wang</a></p>
</blockquote>
<h1 id="alpine-linuxä½¿ç”¨æ•™ç¨‹">alpine linuxä½¿ç”¨æ•™ç¨‹</h1>
<p><a href="http://www.jichun.wang/archives/161/2021/linux/">2021å¹´3æœˆ3æ—¥ (2021å¹´6æœˆ8æ—¥)</a> <a href="http://www.jichun.wang/archives/author/klinux/">Wang Jichun</a></p>
<h2 id="ä¸€-å®‰è£…">ä¸€ã€å®‰è£…</h2>
<p>å®˜æ–¹ç½‘ç«™ï¼š</p>
<p><a href="https://www.alpinelinux.org/">https://www.alpinelinux.org/</a></p>
<p>ä¸‹è½½é•œåƒï¼š<a href="https://www.alpinelinux.org/downloads/">https://www.alpinelinux.org/downloads/</a></p>
<blockquote>
<p>è¿™é‡Œé€‰æ‹©é’ˆå¯¹è™šæ‹ŸåŒ–ä¼˜åŒ–çš„ç‰ˆæœ¬<br>
<img src="https://mypppv.github.io/post-images/1630423291819.jpg" alt="" loading="lazy"></p>
</blockquote>
<p>è¿™é‡Œä½¿ç”¨VMè™šæ‹Ÿæœºå®‰è£…ï¼Œåˆ›å»ºè™šæ‹Ÿæœºé€‰æ‹©ï¼š</p>
<figure data-type="image" tabindex="1"><img src="https://mypppv.github.io/post-images/1630423170678.jpg" alt="" loading="lazy"></figure>
<blockquote>
<p>å¯åŠ¨åè¿›å…¥:<br>
<img src="https://mypppv.github.io/post-images/1630423309831.jpg" alt="" loading="lazy"></p>
</blockquote>
<blockquote>
<p>è¾“å…¥ç”¨æˆ·åï¼šroot</p>
</blockquote>
<blockquote>
<p>è®¾ç½®ç³»ç»Ÿå‚æ•°ï¼šsetup-alpineï¼Œå›è½¦åé€‰æ‹©é”®ç›˜å¸ƒå±€ï¼Œè¿™é‡Œé€‰æ‹©us</p>
</blockquote>
<blockquote>
<p>é€‰æ‹©å˜ä½“é”®ç›˜å¸ƒå±€ï¼Œé€‰æ‹©us</p>
</blockquote>
<blockquote>
<p>è¾“å…¥ä¸»æœºåï¼š</p>
</blockquote>
<blockquote>
<p>åˆå§‹åŒ–ç½‘å¡ï¼Œç›´æ¥å›è½¦ï¼š</p>
<p>é…ç½®ä½¿ç”¨dhcpè·å–åœ°å€ï¼Œç›´æ¥å›è½¦ï¼ˆä¸¤æ¬¡å›è½¦ï¼‰ï¼š</p>
</blockquote>
<blockquote>
<p>è®¾ç½®å¼€æœºå¯†ç ï¼š</p>
</blockquote>
<blockquote>
<p>è®¾ç½®æ—¶åŒºï¼š</p>
</blockquote>
<blockquote>
<p>è®¾ç½®ä¸Šç½‘ä»£ç†ï¼š</p>
</blockquote>
<blockquote>
<p>è®¾ç½®NTPå®¢æˆ·ç«¯ï¼Œä½¿ç”¨chronyåŒæ­¥æ—¶é—´ï¼Œå›è½¦ï¼š</p>
</blockquote>
<blockquote>
<p>é€‰æ‹©é•œåƒä»“åº“ï¼ŒæŒ‰â€˜fâ€™é”®é€‰æ‹©æœ€å¿«çš„é•œåƒæºï¼Œè¿™é‡Œä¼šè¿›è¡Œæµ‹é€Ÿï¼Œä¼šæœ‰ç‚¹æ…¢ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ç¬¬ä¸€é¡¹ï¼Œæ·»åŠ å›½å†…çš„æºï¼š</p>
</blockquote>
<blockquote>
<p>é€‰æ‹©SSHæœåŠ¡ç«¯ï¼šopenssh</p>
</blockquote>
<blockquote>
<p>é€‰æ‹©å®‰è£…ç£ç›˜ï¼š</p>
</blockquote>
<p>alpineæ˜¯å¯ä»¥è¿è¡Œåœ¨å†…å­˜ä¸­çš„ï¼Œå¯ä»¥ä¸å®‰è£…åˆ°ç£ç›˜ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©å®‰è£…åˆ°äº†ç£ç›˜ã€‚</p>
<blockquote>
<p>é€‰æ‹©ç£ç›˜æ ¼å¼ï¼šæˆ‘é€‰sys</p>
<p>sysï¼šä¼ ç»Ÿçš„ç¡¬ç›˜å®‰è£…ï¼Œåˆ›å»ºä¸‰ä¸ªåˆ†åŒºï¼Œ/bootã€äº¤æ¢å’Œ /ï¼ˆæ–‡ä»¶ç³»ç»Ÿæ ¹ï¼‰ã€‚</p>
<p>dataï¼šç³»ç»Ÿè¿è¡Œåœ¨å†…å­˜ä¸­ä½†æ˜¯äº¤æ¢åˆ†åŒºå’Œæ•´ä¸ª /varç›®å½•ä¼šåˆ›å»ºä¸¤ä¸ªæ–°åˆ›å»ºçš„åˆ†åŒºï¼ŒæŒä¹…åŒ–æ•°æ®ã€‚</p>
</blockquote>
<blockquote>
<p>ç£ç›˜æ¸…ç©ºç¡®è®¤ï¼š</p>
</blockquote>
<blockquote>
<p>å®‰è£…å®Œæˆï¼š</p>
</blockquote>
<blockquote>
<p>è¾“å…¥rebooté‡å¯ä¸»æœº</p>
</blockquote>
<blockquote>
<p>è¾“å…¥rootå’Œå¯†ç è¿›å…¥ç³»ç»Ÿï¼š</p>
</blockquote>
<h2 id="äºŒ-ç½‘ç»œé…ç½®">äºŒã€ç½‘ç»œé…ç½®</h2>
<h3 id="21-ipé…ç½®">2.1ã€IPé…ç½®</h3>
<p>IPé…ç½®æ–‡ä»¶ï¼š/etc/network/interfaces</p>
<pre><code>`shortname:~# cat /etc/network/interfaces
auto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp
        hostname alpine` Copy
</code></pre>
<h4 id="ipv4-dhcpé…ç½®"><strong>IPv4 DHCPé…ç½®</strong></h4>
<pre><code>`auto eth0
iface eth0 inet dhcp
        hostname alpine` Copy
</code></pre>
<h4 id="ipv4-é™æ€åœ°å€é…ç½®">IPv4 é™æ€åœ°å€é…ç½®</h4>
<pre><code>`iface eth0 inet static
        address 192.168.1.150
        netmask 255.255.255.0
        gateway 192.168.1.1` Copy
</code></pre>
<p>å¤šåœ°å€é…ç½®</p>
<pre><code>`iface eth0 inet static
        address 192.168.1.150/24
        gateway 192.168.1.1

iface eth0 inet static
        address 192.168.1.151/24` Copy
</code></pre>
<p>é‡å¯ç½‘ç»œæœåŠ¡</p>
<pre><code>`/etc/init.d/networking restart` Copy
</code></pre>
<h3 id="22-é…ç½®dns">2.2ã€é…ç½®DNS</h3>
<pre><code> `echo 'nameserver 223.5.5.5' &gt; /etc/resolv.conf` Copy
</code></pre>
<h3 id="23-ä¿®æ”¹ä¸»æœºå">2.3ã€ä¿®æ”¹ä¸»æœºå</h3>
<pre><code>`echo &quot;alpine.jichun.wang&quot; &gt; /etc/hostname` Copy
</code></pre>
<p>ç«‹åˆ»ç”Ÿæ•ˆ</p>
<pre><code>`hostname -F /etc/hostname` Copy
</code></pre>
<h3 id="24-é…ç½®rootç”¨æˆ·ä½¿ç”¨sshç™»é™†ä¸»æœºä¸å®‰å…¨å¯ä»¥ä¸ç”¨å¼€å¯ä½¿ç”¨æ™®é€šç”¨æˆ·ç™»é™†åœ¨suåˆ°root">2.4ã€é…ç½®rootç”¨æˆ·ä½¿ç”¨SSHç™»é™†ä¸»æœºï¼ˆä¸å®‰å…¨ï¼Œå¯ä»¥ä¸ç”¨å¼€å¯ï¼Œä½¿ç”¨æ™®é€šç”¨æˆ·ç™»é™†ï¼Œåœ¨suåˆ°rootï¼‰</h3>
<blockquote>
<p>è¿™æ­¥æ“ä½œä¸å®‰å…¨ï¼Œéå¿…è¦å¯ä¸æ“ä½œ</p>
</blockquote>
<p>alpineé»˜è®¤æƒ…å†µä¸å…è®¸rootç”¨æˆ·ä½¿ç”¨å¯†ç ç™»é™†ï¼Œå¼€å¯rootç”¨æˆ·ä½¿ç”¨å¯†ç ç™»é™†ï¼š</p>
<pre><code>`# å…è®¸rootç”¨æˆ·ä½¿ç”¨å¯†ç ç™»é™†
echo &quot;PermitRootLogin yes&quot; &gt;&gt; /etc/ssh/sshd_config
# é‡å¯sshdæœåŠ¡
rc-service sshd restart` Copy
</code></pre>
<h2 id="ä¸‰-ä¿®æ”¹å›½å†…æº">ä¸‰ã€ä¿®æ”¹å›½å†…æº</h2>
<p>é…ç½®æ–‡ä»¶ï¼š/etc/apk/repositories</p>
<pre><code>`http://mirrors.ustc.edu.cn/alpine/v3.12/main
http://mirrors.ustc.edu.cn/alpine/v3.12/community` Copy
</code></pre>
<h2 id="å››-è½¯ä»¶åŒ…ç®¡ç†">å››ã€è½¯ä»¶åŒ…ç®¡ç†</h2>
<h3 id="41-è½¯ä»¶å®‰è£…å¸è½½">4.1ã€è½¯ä»¶å®‰è£…å¸è½½</h3>
<pre><code>`shortname:~# apk --help
apk-tools 2.10.5, compiled for x86_64.

Installing and removing packages:
  add       Add PACKAGEs to 'world' and install (or upgrade) them, while ensuring that all dependencies are met
  del       Remove PACKAGEs from 'world' and uninstall them

System maintenance:
  fix       Repair package or upgrade it without modifying main dependencies
  update    Update repository indexes from all remote repositories
  upgrade   Upgrade currently installed packages to match repositories
  cache     Download missing PACKAGEs to cache and/or delete unneeded files from cache

Querying information about packages:
  info      Give detailed information about PACKAGEs or repositories
  list      List packages by PATTERN and other criteria
  search    Search package by PATTERNs or by indexed dependencies
  dot       Generate graphviz graphs
  policy    Show repository policy for packages

Repository maintenance:
  index     Create repository index file from FILEs
  fetch     Download PACKAGEs from global repositories to a local directory
  verify    Verify package integrity and signature
  manifest  Show checksums of package contents

Use apk &lt;command&gt; --help for command-specific help.
Use apk --help --verbose for a full command listing.

This apk has coffee making abilities.` Copy
</code></pre>
<p>å®‰è£…vim</p>
<pre><code>`apk add vim` Copy
</code></pre>
<p>å¸è½½vim</p>
<pre><code>`apk del vim` Copy
</code></pre>
<p>æŸ¥è¯¢è½¯ä»¶åŒ…</p>
<pre><code> `apk search vim` Copy
</code></pre>
<h3 id="42-ç³»ç»Ÿæ›´æ–°å‡çº§">4.2ã€ç³»ç»Ÿæ›´æ–°å‡çº§</h3>
<p>æ›´æ–°è½¯ä»¶ç´¢å¼•</p>
<pre><code>`apk update` Copy
</code></pre>
<p>--no-cacheï¼šç¦ç”¨ç¼“å­˜å®‰è£…è½¯ä»¶åŒ…</p>
<pre><code>`apk add --no-cache vim` Copy
</code></pre>
<p>ä»ç¬¬ä¸‰æ–¹çš„ä»“åº“å®‰è£…è½¯ä»¶</p>
<pre><code>`apk add docker --update-cache --repository http://mirrors.ustc.edu.cn/alpine/v3.4/main/ --allow-untrusted` Copy
</code></pre>
<p>upgradeï¼šå‡çº§ç³»ç»Ÿ</p>
<pre><code>`apk upgrade` Copy
</code></pre>
<h3 id="42-å¸¸ç”¨è½¯ä»¶">4.2ã€å¸¸ç”¨è½¯ä»¶</h3>
<ul>
<li>ssï¼šæŸ¥çœ‹ä¸»æœºç«¯å£ <code>apk add iproute2</code></li>
</ul>
<pre><code>`# æ˜¾ç¤ºtcpç›‘å¬ç«¯å£
ss -tl
# æ˜¾ç¤ºtcpç›‘å¬ç«¯å£å’Œè¿›ç¨‹
ss -ptl
# æ˜¾ç¤ºç›‘å¬å’Œå·²å»ºç«‹çš„é“¾æ¥
ss -ta
# æ˜¾ç¤ºsocketçš„ä½¿ç”¨
ss -s` Copy
</code></pre>
<ul>
<li>drillï¼šdnsè§£æ</li>
</ul>
<p><code>apk add drill</code></p>
<ul>
<li>wget curl vim</li>
</ul>
<p><code>apk add wget curl vim</code></p>
<h2 id="äº”-åŸºæœ¬ç®¡ç†æ“ä½œ">äº”ã€åŸºæœ¬ç®¡ç†æ“ä½œ</h2>
<h3 id="51-å®‰è£…é˜²ç«å¢™">5.1ã€å®‰è£…é˜²ç«å¢™</h3>
<p>å®‰è£…é˜²ç«å¢™</p>
<pre><code>`# iptables
apk add iptables

# è®¾ç½®å¼€æœºå¯åŠ¨
rc-update add iptables 

# ä¿å­˜é˜²ç«å¢™è§„åˆ™
/etc/init.d/iptables save` Copy
</code></pre>
<h3 id="52-æ—¶é—´ç®¡ç†">5.2ã€æ—¶é—´ç®¡ç†</h3>
<p>apk add tzdata<br>
ls /usr/share/zoneinfo</p>
<p>cp /usr/share/zoneinfo/Europe/Brussels /etc/localtime</p>
<p>echo &quot;Europe/Brussels&quot; &gt; /etc/timezone<br>
date</p>
<p>apk del tzdata</p>
<h3 id="53-ä¸»æœºå…³æœºé‡å¯">5.3ã€ä¸»æœºå…³æœºé‡å¯</h3>
<pre><code>`# å…³æœº
poweroff
# é‡å¯
reboot` Copy
</code></pre>
<h3 id="54-æœåŠ¡ç®¡ç†">5.4ã€æœåŠ¡ç®¡ç†</h3>
<p>æœåŠ¡å¯åœ</p>
<pre><code>`service sshd start
service sshd stop
service sshd restart
# æˆ–è€…
rc-service sshd start
rc-service sshd stop
rc-service sshd restart` Copy
</code></pre>
<h3 id="55-å¼€æœºå¯åŠ¨">5.5ã€å¼€æœºå¯åŠ¨</h3>
<p>rc-updateä¸»è¦ç”¨äºä¸åŒè¿è¡Œçº§å¢åŠ æˆ–è€…åˆ é™¤æœåŠ¡ã€‚</p>
<pre><code>`rc-update add sshd boot #å¢åŠ ä¸€ä¸ªæœåŠ¡
rc-update del sshd boot #åˆ é™¤ä¸€ä¸ªæœåŠ¡` Copy
</code></pre>
<p>rc-status ä¸»è¦ç”¨äºè¿è¡Œçº§çš„çŠ¶æ€ç®¡ç†ã€‚</p>
<pre><code>`nas:~# rc-status
Runlevel: default
 crond                                                             [  started  ]
 chronyd                                                           [  started  ]
 sshd                                                              [  started  ]
 acpid                                                             [  started  ]
Dynamic Runlevel: hotplugged
Dynamic Runlevel: needed/wanted
 sysfs                                                             [  started  ]
 fsck                                                              [  started  ]
 root                                                              [  started  ]
 localmount                                                        [  started  ]
Dynamic Runlevel: manual` Copy
</code></pre>
<h3 id="56-alpine-linuxçš„è¿è¡Œçº§åˆ«">5.6ã€Alpine Linuxçš„è¿è¡Œçº§åˆ«</h3>
<ul>
<li>sysinit å†…å­˜å¯åŠ¨æ¨¡å¼</li>
<li>boot æ™®é€šæ¨¡å¼ï¼ˆå¸¸ç”¨æ¨¡å¼ï¼‰</li>
<li>single å•ç”¨æˆ·æ¨¡å¼</li>
<li>reboot é‡å¯æ¨¡å¼</li>
<li>shutdown å…³æœºæ¨¡å¼</li>
</ul>
<p>ä¿®æ”¹è¿è¡Œçº§åˆ«</p>
<pre><code>`openrc single` Copy
</code></pre>
<h2 id="å…­-å¸¸è§è½¯ä»¶å®‰è£…">å…­ã€å¸¸è§è½¯ä»¶å®‰è£…</h2>
<h3 id="61-mysql">6.1ã€mysql</h3>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://wiki.alpinelinux.org/wiki/Production_DataBases_:_mysql">https://wiki.alpinelinux.org/wiki/Production_DataBases_:_mysql</a></p>
<p>å®‰è£…ï¼Œè¿™é‡Œå®‰è£…çš„æ˜¯mariadbï¼š</p>
<pre><code>`apk add mysql mysql-client` Copy
</code></pre>
<p>åˆå§‹åŒ–æ•°æ®åº“</p>
<pre><code>`mysql_install_db --user=mysql --datadir=/var/lib/mysql

rc-service mariadb start

mysqladmin -u root password toor` Copy
</code></pre>
<h3 id="62-å®‰è£…nginx">6.2ã€å®‰è£…nginx</h3>
<pre><code>`# å®‰è£…
apk add  nginx
# å¯åŠ¨
service nginx start
# å¼€æœºå¯åŠ¨
rc-update add nginx` Copy
</code></pre>
<h3 id="63-å®‰è£…nfs">6.3ã€å®‰è£…NFS</h3>
<p>å®‰è£…è½¯ä»¶åŒ…</p>
<pre><code>`apk add nfs-utils` Copy
</code></pre>
<p>è®¾ç½®å¼€æœºå¯åŠ¨</p>
<pre><code>`rc-update add nfs` Copy
</code></pre>
<p>ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š<code>vim /etc/exports</code></p>
<pre><code>`/nfs 192.168.3.0/24(rw,no_root_squash)` Copy
</code></pre>
<p>å¯åŠ¨æœåŠ¡ï¼š</p>
<pre><code>`rc-service nfs start` Copy
</code></pre>
<p>NFSå‚æ•°è§£é‡Š</p>
<pre><code>`rw                # å®¢æˆ·ç«¯å¯¹å…±äº«çš„ç›®å½•å¯è¯»å†™
ro                # å®¢æˆ·ç«¯å¯¹å…±äº«çš„ç›®å½•åªè¯»ä¸å¯å†™
sync              # åŒæ­¥æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯æŠŠå†…å­˜çš„æ•°æ®å®æ—¶å†™å…¥ç¡¬ç›˜ï¼Œä½†è¿™æ ·ä¼šé™ä½ç£ç›˜æ•ˆç‡
async             # éåŒæ­¥æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯æ¯éš”ä¸€æ®µæ—¶é—´æ‰ä¼šæŠŠå†…å­˜çš„æ•°æ®å†™å…¥ç¡¬ç›˜ï¼Œèƒ½ä¿è¯ç£ç›˜æ•ˆç‡ï¼Œä½†å½“å¼‚å¸¸å®•æœº/æ–­ç”µæ—¶ï¼Œä¼šä¸¢å¤±å†…å­˜é‡Œçš„æ•°æ®
no_root_squash    # å®¢æˆ·ç«¯æŒ‚è½½NFSå…±äº«ç›®å½•åï¼Œå®¢æˆ·ç«¯ä¸Šçš„rootç”¨æˆ·ä¸å—è¿™äº›æŒ‚è½½é€‰é¡¹çš„é™åˆ¶ï¼Œæƒé™å¾ˆå¤§
root_squash       # è·Ÿno_root_squashç›¸åï¼Œå®¢æˆ·ç«¯ä¸Šçš„rootç”¨æˆ·å—åˆ°è¿™äº›æŒ‚è½½é€‰é¡¹çš„é™åˆ¶ï¼Œè¢«å½“æˆæ™®é€šç”¨æˆ·
all_squash        # å®¢æˆ·ç«¯ä¸Šçš„æ‰€æœ‰ç”¨æˆ·åœ¨ä½¿ç”¨NFSå…±äº«ç›®å½•æ—¶éƒ½è¢«é™å®šä¸ºä¸€ä¸ªæ™®é€šç”¨æˆ·
anonuid           # ä¸Šé¢çš„å‡ ä¸ªsquashç”¨äºæŠŠå®¢æˆ·ç«¯çš„ç”¨æˆ·é™å®šä¸ºæ™®é€šç”¨æˆ·ï¼Œè€Œanouidç”¨äºé™å®šè¿™ä¸ªæ™®é€šç”¨æˆ·çš„uidï¼Œè¿™ä¸ªuidä¸æœåŠ¡ç«¯çš„/etc/passwdæ–‡ä»¶ç›¸å¯¹åº”ï¼Œå¦‚ï¼šanouid=1000
                  # æ¯”å¦‚æˆ‘å®¢æˆ·ç«¯ç”¨xiaomingè¿™ä¸ªç”¨æˆ·å»åˆ›å»ºæ–‡ä»¶ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯åŒæ­¥è¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œæ–‡ä»¶çš„å±ä¸»ä¼šå˜æˆæœåŠ¡ç«¯çš„uid(1000)æ‰€å¯¹åº”çš„ç”¨æˆ·
anongid           # åŒä¸Šï¼Œç”¨äºé™å®šè¿™ä¸ªæ™®é€šç”¨æˆ·çš„gid` Copy
</code></pre>
<h2 id="ä¸ƒ-dockerä¸­ä½¿ç”¨alpine">ä¸ƒã€dockerä¸­ä½¿ç”¨alpine</h2>
<p>æ‹‰å–é•œåƒï¼š</p>
<p><a href="https://hub.docker.com/_/alpine?tab=tags">https://hub.docker.com/_/alpine?tab=tags</a></p>
<pre><code>`docker pull alpine` Copy
</code></pre>
<p>dockeré•œåƒæ„å»ºä¸­å¸¸ç”¨çš„å‘½ä»¤ï¼š</p>
<p>è®¾ç½®æ—¶åŒºï¼š</p>
<pre><code>`apk add --no-cache tzdata &amp;&amp;
cp /usr/share/zoneinfo/Europe/Brussels /etc/localtime &amp;&amp;
echo &quot;Asia/Shanghai&quot; &gt;  /etc/timezone &amp;&amp;
apk del --no-cache tzdata` Copy
</code></pre>
<p><a href="http://www.jichun.wang/archives/category/linux/">Linux</a><a href="http://www.jichun.wang/archives/tag/alpine/">alpine</a>ï¼Œ<a href="http://www.jichun.wang/archives/tag/linux/">Linux</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[freebsdä½¿ç”¨boundä½œä¸ºdnsæœåŠ¡å™¨]]></title>
        <id>https://mypppv.github.io/post/freebsd-shi-yong-bound-zuo-wei-dns-fu-wu-qi/</id>
        <link href="https://mypppv.github.io/post/freebsd-shi-yong-bound-zuo-wei-dns-fu-wu-qi/">
        </link>
        <updated>2021-08-29T14:41:07.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>
<p>å®‰è£…pkgï¼Œshellè¾“å…¥pkgå³å¯å®‰è£…</p>
</li>
<li>
<p>å®‰è£…unbound</p>
<pre><code>pkg install unbound
</code></pre>
</li>
<li>
<p>é…ç½®æ–‡ä»¶  /usr/local/etc/unbound/unbound.conf</p>
</li>
</ul>
<pre><code>##########################
# Unbound Configuration
##########################

# Server configuration
server:
chroot: /mnt
username: unbound
directory: /mnt
root-hints: /mnt/root.hints
use-syslog: yes
port: 53
verbosity: 1
extended-statistics: no
log-queries: no
hide-identity: no
hide-version: no
harden-referral-path: no
do-ip4: yes
do-ip6: yes
do-udp: yes
do-tcp: yes
do-daemonize: yes
so-reuseport: yes
module-config: &quot;iterator&quot;
cache-max-ttl: 86400
cache-min-ttl: 0
harden-dnssec-stripped: no
serve-expired: yes
outgoing-num-tcp: 50
incoming-num-tcp: 50
num-queries-per-thread: 4096
outgoing-range: 8192
infra-host-ttl: 900
infra-cache-numhosts: 50000
unwanted-reply-threshold: 0
jostle-timeout: 500
msg-cache-size: 512m
rrset-cache-size: 1024m
num-threads: 1
msg-cache-slabs: 2
rrset-cache-slabs: 2
infra-cache-slabs: 2
key-cache-slabs: 2

prefetch: yes
prefetch-key: yes

# Interface IP(s) to bind to
interface: 127.0.0.1
interface: 0.0.0.0 #æœ¬æœºipåœ°å€
interface: ::1
# DNS Rebinding
# For DNS Rebinding prevention
# All these addresses are either private or should not be routable in the global IPv4 or IPv6 internet.
# IPv4 Addresses
private-address: 0.0.0.0/8       # Broadcast address
private-address: 10.0.0.0/8
private-address: 100.64.0.0/10
private-address: 127.0.0.0/8     # Loopback Localhost
private-address: 169.254.0.0/16
private-address: 172.16.0.0/12
private-address: 192.0.2.0/24    # Documentation network TEST-NET
private-address: 192.168.0.0/16
private-address: 198.18.0.0/15   # Used for testing inter-network communications
private-address: 198.51.100.0/24 # Documentation network TEST-NET-2
private-address: 203.0.113.0/24  # Documentation network TEST-NET-3
private-address: 233.252.0.0/24  # Documentation network MCAST-TEST-NET
#
# IPv6 Addresses
#
private-address: ::1/128         # Loopback Localhost
private-address: 2001:db8::/32   # Documentation network IPv6
private-address: fc00::/8        # Unique local address (ULA) part of &quot;fc00::/7&quot;, not defined yet
private-address: fd00::/8        # Unique local address (ULA) part of &quot;fc00::/7&quot;, &quot;/48&quot; prefix group
private-address: fe80::/10       # Link-local address (LLA)

# Access lists
include: /mnt/access_lists.conf
# Static host entries
include: /mnt/host_entries.conf
# DHCP leases (if configured)
include: /mnt/dhcpleases.conf
# Domain overrides
include: /mnt/domainoverrides.conf
remote-control:
    control-enable: yes
    control-interface: 127.0.0.1
    control-port: 953
    server-key-file: /mnt/unbound_server.key
    server-cert-file: /mnt/unbound_server.pem
    control-key-file: /mnt/unbound_control.key
    control-cert-file: /mnt/unbound_control.pem
forward-zone:
  name: .
  forward-addr: 223.5.5.5
	forward-addr: 180.76.76.76
	forward-addr: 223.6.6.6
	forward-addr: 114.114.114.114
	forward-addr: 8.8.8.8
	forward-addr: 8.8.4.4

</code></pre>
<ul>
<li>
<p>å…¶ä¸­æ¶‰åŠçš„ä¸€äº›å¤–éƒ¨æ–‡ä»¶</p>
<p>https://github.com/mypppv/myconfig/blob/6ab4aa8e250155b55d508c4532c305ebc4c75fc2/unbound_config.zip</p>
<p>ä¸‹è½½ä¹‹åè§£å‹æ‹·è´åˆ° /mntå³å¯</p>
</li>
<li>
<p>ä»¥ä¸‹æ˜¯unboundå¸¸è§å‘½ä»¤</p>
<pre><code>unbound               unbound-checkconf     unbound-control-setup
unbound-anchor        unbound-control       unbound-host
</code></pre>
</li>
<li>
<p>å¯åŠ¨unbound</p>
<pre><code>unbound
</code></pre>
</li>
<li>
<p>è®¾ç½®å¼€æœºå¯åŠ¨</p>
<pre><code>ee /etc/rc
#å¢åŠ  
unbound_enable=&quot;YES&quot;
</code></pre>
</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[freebsd è®¾ç½®local-unbound]]></title>
        <id>https://mypppv.github.io/post/freebsd-she-zhi-local-unbound/</id>
        <link href="https://mypppv.github.io/post/freebsd-she-zhi-local-unbound/">
        </link>
        <updated>2021-08-29T14:40:29.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>
<p>å…ˆè®¾ç½®æœ¬åœ°dnsæœåŠ¡å™¨ï¼Œä¿®æ”¹/etc/resolv.conf</p>
<pre><code>root@freebsd:~ # cat /etc/resolv.conf
# Generated by resolvconf
nameserver 223.5.5.5
nameserver 180.76.76.76
nameserver 223.6.6.6
nameserver 114.114.114.114
nameserver 8.8.8.8
nameserver 8.8.4.4
nameserver 127.0.0.1
options edns0
</code></pre>
<p>è®¾ç½®local-unbound å¼€æœºå¯åŠ¨ï¼š</p>
</li>
</ul>
<pre><code> sysrc local_unbound_enable=YES
</code></pre>
<ul>
<li>
<p>ä¸Šè¿°è®¾ç½®ï¼Œä¼šåœ¨ä¸‹æ¬¡å¯åŠ¨åç”Ÿæ•ˆï¼Œå¼€æœºå¯åŠ¨</p>
</li>
<li>
<p>ç«‹å³å¯åŠ¨çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> service local_unbound onestart
 service local_unbound onerestart #é‡å¯
</code></pre>
<pre><code>root@freebsd:~ # service local_unbound onestart
Performing initial setup.
destination:
Extracting forwarders from /etc/resolv.conf.
/var/unbound/forward.conf created
/var/unbound/lan-zones.conf created
/var/unbound/control.conf created
/var/unbound/unbound.conf created
/etc/resolvconf.conf created
Original /etc/resolv.conf saved as /var/backups/resolv.conf.20210829.203646
Starting local_unbound.
</code></pre>
</li>
<li>
<p>æ³¨æ„ï¼š/var/unbound/forward.conf æ˜¯ä¸å¯æ‰‹åŠ¨æ›´æ”¹çš„ï¼Œå¦‚æœæƒ³æ›´æ”¹ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<pre><code>1ã€è®¾ç½®æœ¬åœ°dnsæœåŠ¡å™¨ï¼Œä¿®æ”¹/etc/resolv.confï¼Œå¢åŠ nameserver
2ã€è¿è¡Œå‘½ä»¤ï¼šlocal-unbound-setup
</code></pre>
</li>
<li>
<p>å…¸å‹DNSæœåŠ¡å™¨å¦‚ä¸‹ï¼š</p>
<pre><code>nameserver 223.5.5.5
nameserver 180.76.76.76
nameserver 223.6.6.6
nameserver 114.114.114.114
nameserver 8.8.8.8
nameserver 8.8.4.4
</code></pre>
</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[freebsd æŸ¥çœ‹ç«¯å£å ç”¨]]></title>
        <id>https://mypppv.github.io/post/freebsd-cha-kan-duan-kou-zhan-yong/</id>
        <link href="https://mypppv.github.io/post/freebsd-cha-kan-duan-kou-zhan-yong/">
        </link>
        <updated>2021-08-29T12:33:55.000Z</updated>
        <content type="html"><![CDATA[<p>ä½¿ç”¨25ç«¯å£å ç”¨æƒ…å†µï¼Œæ‰§è¡Œ sockstat -4l | grep 25 å³å¯ï¼š</p>
<pre><code>root@freebsd:~ #  sockstat -4l | grep 25
root     sendmail   820   3  tcp4   127.0.0.1:25          *:*
</code></pre>
<p>å¯ä»¥çœ‹åˆ°25ç«¯å£çš„è¿›è¡Œå·æ˜¯38386ï¼Œé€šè¿‡ kill -9 38386 æ€æ‰è¯¥è¿›ç¨‹ï¼š</p>
<p>å ç”¨25ç«¯å£çš„è¿›è¡Œå·å·²è¢«æ€æ‰ã€‚</p>
<p>è¡¥å……è¯´æ˜ï¼š</p>
<p>sockstat -4l â€”â€”å¯ä»¥æŸ¥çœ‹ä¾¦å¬ç«¯å£çš„ç¨‹åºï¼Œå…¶ä¸­4è¡¨ç¤ºipv4ï¼Œlè¡¨ç¤ºlisten</p>
<p>sockstat -4c â€”â€”å¯ä»¥æŸ¥çœ‹å·²å»ºç«‹çš„è¿æ¥çŠ¶å†µã€‚</p>
<p>sockstat -4 â€”â€”ç­‰äºä¸Šè¿°ä¸¤ä¸ªå‘½ä»¤çš„å’Œã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[# FreeBSDå¼€å¯SSHè¿œç¨‹ç™»å½•]]></title>
        <id>https://mypppv.github.io/post/freebsd-kai-qi-ssh-yuan-cheng-deng-lu/</id>
        <link href="https://mypppv.github.io/post/freebsd-kai-qi-ssh-yuan-cheng-deng-lu/">
        </link>
        <updated>2021-08-29T11:30:52.000Z</updated>
        <content type="html"><![CDATA[<p>1ã€å®‰è£…æ—¶é€‰æ‹©ä¸ŠSSHï¼Œæˆ–è€…æºç å®‰è£…SSH<br>
2ã€ä½¿ç”¨rootç™»é™†ç³»ç»Ÿï¼ˆåˆå§‹æ— å¯†ç ï¼‰<br>
4ã€ç¼–è¾‘/etc/rc.confï¼Œæ·»åŠ ä¸€è¡Œsshd_enable=&quot;YES&quot;<br>
5ã€ç¼–è¾‘/etc/ssh/sshd_configï¼Œå°†<br>
#PermitRootLogin noæ”¹ä¸ºPermitRootLogin yes //å…è®¸rootç™»é™†<br>
#PasswordAuthentication noæ”¹ä¸ºPasswordAuthenticationyes//ä½¿ç”¨ç³»ç»ŸPAMè®¤è¯<br>
#PermitEmptyPasswords noæ”¹ä¸ºPermitEmptyPasswords no//ä¸å…è®¸ç©ºå¯†ç </p>
<p>ä¿®æ”¹ç«¯å£å·ï¼š/etc/ssh/sshd_config</p>
<p>#port=22æ”¹ä¸º Port=numberï¼ˆä½ æƒ³ä¿®æ”¹çš„æ•°å­—ï¼‰</p>
<p>ä¿å­˜é€€å‡º<br>
6ã€å¯åŠ¨SSHDæœåŠ¡ï¼Œ/etc/rc.d/sshd onestart<br>
7ã€æŸ¥çœ‹æœåŠ¡æ˜¯å¦å¯åŠ¨ï¼Œnetstat -anï¼Œå¦‚æœçœ‹åˆ°22ç«¯å£æœ‰ç›‘å¬ï¼Œæ­å–œï¼ï¼ï¼</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[windowsä½¿ç”¨cmdå‘½ä»¤å¿«é€Ÿè®¾ç½®ç½‘å¡åœ°å€]]></title>
        <id>https://mypppv.github.io/post/windows-shi-yong-cmd-ming-ling-kuai-su-she-zhi-wang-qia-di-zhi/</id>
        <link href="https://mypppv.github.io/post/windows-shi-yong-cmd-ming-ling-kuai-su-she-zhi-wang-qia-di-zhi/">
        </link>
        <updated>2021-08-28T07:35:16.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>ä¸€é”®è®¾ç½®ç½‘å¡ipåœ°å€</li>
</ul>
<pre><code class="language-bash">netsh interface ip set address &quot;eth0&quot; static 10.0.0.158 255.255.255.0 10.0.0.3
netsh interface ip set dns &quot;eth0&quot; static 10.0.0.3
pause
</code></pre>
<p>å¦‚ä¸‹å›¾ï¼Œç½‘å¡åç§°æ‰‹åŠ¨æ”¹æˆäº†&quot;eth0&quot;<br>
<img src="https://mypppv.github.io/post-images/1630136293101.png" alt="" loading="lazy"></p>
<ul>
<li>ä¸€é”®è®¾ç½®è‡ªåŠ¨è·å–ipå’Œdns</li>
</ul>
<pre><code class="language-bash">netsh interface ip set address &quot;eth0&quot;  dhcp
netsh interface ip set dns name=&quot;eth0&quot; source=dhcp
pause
</code></pre>
<ul>
<li>å‡çº§ç‰ˆè„šæœ¬,å¯ä»¥è‡ªåŠ¨åˆ¤æ–­å¹¶è®¾ç½®ipåœ°å€</li>
</ul>
<pre><code>@echo off
netsh interface ip  show dnsservers | findstr 10.0.0.3
if %errorlevel% NEQ 1 GOTO set_ip_dhcp
:set_ip_static_addr
netsh interface ip set address &quot;eth0&quot; static 10.0.0.158 255.255.255.0 10.0.0.3
netsh interface ip set dns &quot;eth0&quot; static 10.0.0.3
cls
echo &quot;è®¾ç½®äº†é™æ€ipåœ°å€&quot;
pause
exit
:set_ip_dhcp
netsh interface ip set address &quot;eth0&quot;  dhcp
netsh interface ip set dns name=&quot;eth0&quot; source=dhcp
cls
echo &quot;å–æ¶ˆäº†é™æ€ipåœ°å€&quot;
pause
exit
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ipv6 windows æŸ¥è¯¢mtu]]></title>
        <id>https://mypppv.github.io/post/ipv6-windows-cha-xun-mtu/</id>
        <link href="https://mypppv.github.io/post/ipv6-windows-cha-xun-mtu/">
        </link>
        <updated>2021-08-28T06:55:12.000Z</updated>
        <content type="html"><![CDATA[<p><code>C:\Users\root&gt;Netsh interface ipv6 show interface</code></p>
<pre><code>Idx     Met         MTU          çŠ¶æ€                åç§°

---  ----------  ----------  ------------  ---------------------------

  1          75  4294967295  connected     Loopback Pseudo-Interface 1

 31          35        1500  disconnected  VPN - VPN Client

  4          25        1280  connected     ä»¥å¤ªç½‘

 35          25        1500  disconnected  æœ¬åœ°è¿æ¥

 39           5        1420  connected     client

 29          35        1500  connected     VMware Network Adapter VMnet1

 30          35        1500  connected     VMware Network Adapter VMnet8
</code></pre>
]]></content>
    </entry>
</feed>