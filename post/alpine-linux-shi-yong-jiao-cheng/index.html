<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>alpine linux使用教程 | 若水</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://mypppv.github.io/favicon.ico?v=1630724240651">
<link rel="stylesheet" href="https://mypppv.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="
本文由 简悦 SimpRead 转码， 原文地址 www.jichun.wang

alpine linux使用教程
2021年3月3日 (2021年6月8日) Wang Jichun
一、安装
官方网站：
https://www.alp..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://mypppv.github.io">
        <img src="https://mypppv.github.io/images/avatar.png?v=1630724240651" class="site-logo">
        <h1 class="site-title">若水</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      <h2 ><code>上善若水，水善利万物而不争，处众人之所恶，故几于道。</code></h2>
<p>&nbsp;</p>
    </div>
    <div class="site-footer">
      <h2 ><code>欢迎访问</code></h2>
<p>&nbsp;</p> | <a class="rss" href="https://mypppv.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">alpine linux使用教程</h2>
            <div class="post-date">2021-08-31</div>
            
            <div class="post-content" v-pre>
              <blockquote>
<p>本文由 <a href="http://ksria.com/simpread/">简悦 SimpRead</a> 转码， 原文地址 <a href="http://www.jichun.wang/archives/161/2021/linux/">www.jichun.wang</a></p>
</blockquote>
<h1 id="alpine-linux使用教程">alpine linux使用教程</h1>
<p><a href="http://www.jichun.wang/archives/161/2021/linux/">2021年3月3日 (2021年6月8日)</a> <a href="http://www.jichun.wang/archives/author/klinux/">Wang Jichun</a></p>
<h2 id="一-安装">一、安装</h2>
<p>官方网站：</p>
<p><a href="https://www.alpinelinux.org/">https://www.alpinelinux.org/</a></p>
<p>下载镜像：<a href="https://www.alpinelinux.org/downloads/">https://www.alpinelinux.org/downloads/</a></p>
<blockquote>
<p>这里选择针对虚拟化优化的版本<br>
<img src="https://mypppv.github.io/post-images/1630423291819.jpg" alt="" loading="lazy"></p>
</blockquote>
<p>这里使用VM虚拟机安装，创建虚拟机选择：</p>
<figure data-type="image" tabindex="1"><img src="https://mypppv.github.io/post-images/1630423170678.jpg" alt="" loading="lazy"></figure>
<blockquote>
<p>启动后进入:<br>
<img src="https://mypppv.github.io/post-images/1630423309831.jpg" alt="" loading="lazy"></p>
</blockquote>
<blockquote>
<p>输入用户名：root</p>
</blockquote>
<blockquote>
<p>设置系统参数：setup-alpine，回车后选择键盘布局，这里选择us</p>
</blockquote>
<blockquote>
<p>选择变体键盘布局，选择us</p>
</blockquote>
<blockquote>
<p>输入主机名：</p>
</blockquote>
<blockquote>
<p>初始化网卡，直接回车：</p>
<p>配置使用dhcp获取地址，直接回车（两次回车）：</p>
</blockquote>
<blockquote>
<p>设置开机密码：</p>
</blockquote>
<blockquote>
<p>设置时区：</p>
</blockquote>
<blockquote>
<p>设置上网代理：</p>
</blockquote>
<blockquote>
<p>设置NTP客户端，使用chrony同步时间，回车：</p>
</blockquote>
<blockquote>
<p>选择镜像仓库，按‘f’键选择最快的镜像源，这里会进行测速，会有点慢，也可以选择第一项，添加国内的源：</p>
</blockquote>
<blockquote>
<p>选择SSH服务端：openssh</p>
</blockquote>
<blockquote>
<p>选择安装磁盘：</p>
</blockquote>
<p>alpine是可以运行在内存中的，可以不安装到磁盘，我这里选择安装到了磁盘。</p>
<blockquote>
<p>选择磁盘格式：我选sys</p>
<p>sys：传统的硬盘安装，创建三个分区，/boot、交换和 /（文件系统根）。</p>
<p>data：系统运行在内存中但是交换分区和整个 /var目录会创建两个新创建的分区，持久化数据。</p>
</blockquote>
<blockquote>
<p>磁盘清空确认：</p>
</blockquote>
<blockquote>
<p>安装完成：</p>
</blockquote>
<blockquote>
<p>输入reboot重启主机</p>
</blockquote>
<blockquote>
<p>输入root和密码进入系统：</p>
</blockquote>
<h2 id="二-网络配置">二、网络配置</h2>
<h3 id="21-ip配置">2.1、IP配置</h3>
<p>IP配置文件：/etc/network/interfaces</p>
<pre><code>`shortname:~# cat /etc/network/interfaces
auto lo
iface lo inet loopback

auto eth0
iface eth0 inet dhcp
        hostname alpine` Copy
</code></pre>
<h4 id="ipv4-dhcp配置"><strong>IPv4 DHCP配置</strong></h4>
<pre><code>`auto eth0
iface eth0 inet dhcp
        hostname alpine` Copy
</code></pre>
<h4 id="ipv4-静态地址配置">IPv4 静态地址配置</h4>
<pre><code>`iface eth0 inet static
        address 192.168.1.150
        netmask 255.255.255.0
        gateway 192.168.1.1` Copy
</code></pre>
<p>多地址配置</p>
<pre><code>`iface eth0 inet static
        address 192.168.1.150/24
        gateway 192.168.1.1

iface eth0 inet static
        address 192.168.1.151/24` Copy
</code></pre>
<p>重启网络服务</p>
<pre><code>`/etc/init.d/networking restart` Copy
</code></pre>
<h3 id="22-配置dns">2.2、配置DNS</h3>
<pre><code> `echo 'nameserver 223.5.5.5' &gt; /etc/resolv.conf` Copy
</code></pre>
<h3 id="23-修改主机名">2.3、修改主机名</h3>
<pre><code>`echo &quot;alpine.jichun.wang&quot; &gt; /etc/hostname` Copy
</code></pre>
<p>立刻生效</p>
<pre><code>`hostname -F /etc/hostname` Copy
</code></pre>
<h3 id="24-配置root用户使用ssh登陆主机不安全可以不用开启使用普通用户登陆在su到root">2.4、配置root用户使用SSH登陆主机（不安全，可以不用开启，使用普通用户登陆，在su到root）</h3>
<blockquote>
<p>这步操作不安全，非必要可不操作</p>
</blockquote>
<p>alpine默认情况不允许root用户使用密码登陆，开启root用户使用密码登陆：</p>
<pre><code>`# 允许root用户使用密码登陆
echo &quot;PermitRootLogin yes&quot; &gt;&gt; /etc/ssh/sshd_config
# 重启sshd服务
rc-service sshd restart` Copy
</code></pre>
<h2 id="三-修改国内源">三、修改国内源</h2>
<p>配置文件：/etc/apk/repositories</p>
<pre><code>`http://mirrors.ustc.edu.cn/alpine/v3.12/main
http://mirrors.ustc.edu.cn/alpine/v3.12/community` Copy
</code></pre>
<h2 id="四-软件包管理">四、软件包管理</h2>
<h3 id="41-软件安装卸载">4.1、软件安装卸载</h3>
<pre><code>`shortname:~# apk --help
apk-tools 2.10.5, compiled for x86_64.

Installing and removing packages:
  add       Add PACKAGEs to 'world' and install (or upgrade) them, while ensuring that all dependencies are met
  del       Remove PACKAGEs from 'world' and uninstall them

System maintenance:
  fix       Repair package or upgrade it without modifying main dependencies
  update    Update repository indexes from all remote repositories
  upgrade   Upgrade currently installed packages to match repositories
  cache     Download missing PACKAGEs to cache and/or delete unneeded files from cache

Querying information about packages:
  info      Give detailed information about PACKAGEs or repositories
  list      List packages by PATTERN and other criteria
  search    Search package by PATTERNs or by indexed dependencies
  dot       Generate graphviz graphs
  policy    Show repository policy for packages

Repository maintenance:
  index     Create repository index file from FILEs
  fetch     Download PACKAGEs from global repositories to a local directory
  verify    Verify package integrity and signature
  manifest  Show checksums of package contents

Use apk &lt;command&gt; --help for command-specific help.
Use apk --help --verbose for a full command listing.

This apk has coffee making abilities.` Copy
</code></pre>
<p>安装vim</p>
<pre><code>`apk add vim` Copy
</code></pre>
<p>卸载vim</p>
<pre><code>`apk del vim` Copy
</code></pre>
<p>查询软件包</p>
<pre><code> `apk search vim` Copy
</code></pre>
<h3 id="42-系统更新升级">4.2、系统更新升级</h3>
<p>更新软件索引</p>
<pre><code>`apk update` Copy
</code></pre>
<p>--no-cache：禁用缓存安装软件包</p>
<pre><code>`apk add --no-cache vim` Copy
</code></pre>
<p>从第三方的仓库安装软件</p>
<pre><code>`apk add docker --update-cache --repository http://mirrors.ustc.edu.cn/alpine/v3.4/main/ --allow-untrusted` Copy
</code></pre>
<p>upgrade：升级系统</p>
<pre><code>`apk upgrade` Copy
</code></pre>
<h3 id="42-常用软件">4.2、常用软件</h3>
<ul>
<li>ss：查看主机端口 <code>apk add iproute2</code></li>
</ul>
<pre><code>`# 显示tcp监听端口
ss -tl
# 显示tcp监听端口和进程
ss -ptl
# 显示监听和已建立的链接
ss -ta
# 显示socket的使用
ss -s` Copy
</code></pre>
<ul>
<li>drill：dns解析</li>
</ul>
<p><code>apk add drill</code></p>
<ul>
<li>wget curl vim</li>
</ul>
<p><code>apk add wget curl vim</code></p>
<h2 id="五-基本管理操作">五、基本管理操作</h2>
<h3 id="51-安装防火墙">5.1、安装防火墙</h3>
<p>安装防火墙</p>
<pre><code>`# iptables
apk add iptables

# 设置开机启动
rc-update add iptables 

# 保存防火墙规则
/etc/init.d/iptables save` Copy
</code></pre>
<h3 id="52-时间管理">5.2、时间管理</h3>
<p>apk add tzdata<br>
ls /usr/share/zoneinfo</p>
<p>cp /usr/share/zoneinfo/Europe/Brussels /etc/localtime</p>
<p>echo &quot;Europe/Brussels&quot; &gt; /etc/timezone<br>
date</p>
<p>apk del tzdata</p>
<h3 id="53-主机关机重启">5.3、主机关机重启</h3>
<pre><code>`# 关机
poweroff
# 重启
reboot` Copy
</code></pre>
<h3 id="54-服务管理">5.4、服务管理</h3>
<p>服务启停</p>
<pre><code>`service sshd start
service sshd stop
service sshd restart
# 或者
rc-service sshd start
rc-service sshd stop
rc-service sshd restart` Copy
</code></pre>
<h3 id="55-开机启动">5.5、开机启动</h3>
<p>rc-update主要用于不同运行级增加或者删除服务。</p>
<pre><code>`rc-update add sshd boot #增加一个服务
rc-update del sshd boot #删除一个服务` Copy
</code></pre>
<p>rc-status 主要用于运行级的状态管理。</p>
<pre><code>`nas:~# rc-status
Runlevel: default
 crond                                                             [  started  ]
 chronyd                                                           [  started  ]
 sshd                                                              [  started  ]
 acpid                                                             [  started  ]
Dynamic Runlevel: hotplugged
Dynamic Runlevel: needed/wanted
 sysfs                                                             [  started  ]
 fsck                                                              [  started  ]
 root                                                              [  started  ]
 localmount                                                        [  started  ]
Dynamic Runlevel: manual` Copy
</code></pre>
<h3 id="56-alpine-linux的运行级别">5.6、Alpine Linux的运行级别</h3>
<ul>
<li>sysinit 内存启动模式</li>
<li>boot 普通模式（常用模式）</li>
<li>single 单用户模式</li>
<li>reboot 重启模式</li>
<li>shutdown 关机模式</li>
</ul>
<p>修改运行级别</p>
<pre><code>`openrc single` Copy
</code></pre>
<h2 id="六-常见软件安装">六、常见软件安装</h2>
<h3 id="61-mysql">6.1、mysql</h3>
<p>参考链接：<a href="https://wiki.alpinelinux.org/wiki/Production_DataBases_:_mysql">https://wiki.alpinelinux.org/wiki/Production_DataBases_:_mysql</a></p>
<p>安装，这里安装的是mariadb：</p>
<pre><code>`apk add mysql mysql-client` Copy
</code></pre>
<p>初始化数据库</p>
<pre><code>`mysql_install_db --user=mysql --datadir=/var/lib/mysql

rc-service mariadb start

mysqladmin -u root password toor` Copy
</code></pre>
<h3 id="62-安装nginx">6.2、安装nginx</h3>
<pre><code>`# 安装
apk add  nginx
# 启动
service nginx start
# 开机启动
rc-update add nginx` Copy
</code></pre>
<h3 id="63-安装nfs">6.3、安装NFS</h3>
<p>安装软件包</p>
<pre><code>`apk add nfs-utils` Copy
</code></pre>
<p>设置开机启动</p>
<pre><code>`rc-update add nfs` Copy
</code></pre>
<p>修改配置文件：<code>vim /etc/exports</code></p>
<pre><code>`/nfs 192.168.3.0/24(rw,no_root_squash)` Copy
</code></pre>
<p>启动服务：</p>
<pre><code>`rc-service nfs start` Copy
</code></pre>
<p>NFS参数解释</p>
<pre><code>`rw                # 客户端对共享的目录可读写
ro                # 客户端对共享的目录只读不可写
sync              # 同步模式，也就是把内存的数据实时写入硬盘，但这样会降低磁盘效率
async             # 非同步模式，也就是每隔一段时间才会把内存的数据写入硬盘，能保证磁盘效率，但当异常宕机/断电时，会丢失内存里的数据
no_root_squash    # 客户端挂载NFS共享目录后，客户端上的root用户不受这些挂载选项的限制，权限很大
root_squash       # 跟no_root_squash相反，客户端上的root用户受到这些挂载选项的限制，被当成普通用户
all_squash        # 客户端上的所有用户在使用NFS共享目录时都被限定为一个普通用户
anonuid           # 上面的几个squash用于把客户端的用户限定为普通用户，而anouid用于限定这个普通用户的uid，这个uid与服务端的/etc/passwd文件相对应，如：anouid=1000
                  # 比如我客户端用xiaoming这个用户去创建文件，那么服务端同步这个文件的时候，文件的属主会变成服务端的uid(1000)所对应的用户
anongid           # 同上，用于限定这个普通用户的gid` Copy
</code></pre>
<h2 id="七-docker中使用alpine">七、docker中使用alpine</h2>
<p>拉取镜像：</p>
<p><a href="https://hub.docker.com/_/alpine?tab=tags">https://hub.docker.com/_/alpine?tab=tags</a></p>
<pre><code>`docker pull alpine` Copy
</code></pre>
<p>docker镜像构建中常用的命令：</p>
<p>设置时区：</p>
<pre><code>`apk add --no-cache tzdata &amp;&amp;
cp /usr/share/zoneinfo/Europe/Brussels /etc/localtime &amp;&amp;
echo &quot;Asia/Shanghai&quot; &gt;  /etc/timezone &amp;&amp;
apk del --no-cache tzdata` Copy
</code></pre>
<p><a href="http://www.jichun.wang/archives/category/linux/">Linux</a><a href="http://www.jichun.wang/archives/tag/alpine/">alpine</a>，<a href="http://www.jichun.wang/archives/tag/linux/">Linux</a></p>

            </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://mypppv.github.io/post/freebsd-shi-yong-bound-zuo-wei-dns-fu-wu-qi/">
                  <h3 class="post-title">
                    freebsd使用bound作为dns服务器
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>






  </body>
</html>
